<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kết quả Bài toán Quy hoạch Tuyến tính</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f4f7f9; /* Slightly lighter and cooler background */
            color: #374151; /* Darker gray for better contrast (Tailwind gray-700) */
            line-height: 1.6;
        }

        .container-wrapper {
            max-width: 1000px;
            margin: 2rem auto; /* Added more top/bottom margin for better page centering */
            background-color: white;
            border-radius: 0.75rem; /* 12px */
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1); /* Softer, more diffused shadow */
            overflow: hidden;
        }
        
        .back-button {
            display: inline-flex;
            align-items: center;
            background-color: #4f46e5; /* Indigo 600 */
            color: white;
            font-weight: 500; /* medium */
            padding: 0.75rem 1.5rem; /* Slightly larger padding */
            border-radius: 0.5rem; /* Slightly larger radius */
            transition: all 0.2s ease-in-out; /* Faster transition */
            margin-bottom: 2rem; /* Increased margin */
            text-decoration: none;
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Shadow with button color tint */
        }
        
        .back-button:hover {
            background-color: #4338ca; /* Indigo 700 */
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.25), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .back-button svg {
            margin-right: 0.625rem; /* 10px */
        }
        
        .results-header {
            padding: 2rem 1.75rem; /* Adjusted padding */
            background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%); /* Gradient header */
            color: white;
            margin-bottom: 2rem; /* Increased spacing after header */
        }

        h1.main-title { 
            font-size: 2.5rem; /* Slightly larger */
            font-weight: 700; 
            margin-bottom: 0.75rem; /* Increased margin */
            text-align: center;
            color: white; 
        }

        p.subtitle { 
            text-align: center;
            color: #e0e7ff; /* Lighter indigo (Indigo 100) for subtitle for softer contrast */
            margin-top: 0.25rem; 
            font-size: 1.125rem; 
            font-weight: 300; /* Lighter font weight for subtitle */
        }
        
        .content-wrapper { 
            padding: 0 2.5rem 2.5rem 2.5rem; /* Increased padding */
        }

        h2.section-title { 
            font-size: 1.875rem; /* Slightly larger */
            font-weight: 600; 
            color: #4338ca; /* Indigo 700 */
            margin-top: 3rem; /* Increased top margin */
            margin-bottom: 1.5rem; /* Increased bottom margin */
            padding-bottom: 0.75rem; /* Increased padding */
            border-bottom: 1px solid #c7d2fe; /* Lighter, thinner border (Indigo 200) */
            display: flex;
            align-items: center;
        }

        h2.section-title svg, h2.section-title .icon { /* Targeting both SVG and potential text icon */
            margin-right: 0.875rem; /* 14px */
            color: #4f46e5; /* Indigo 600 */
            width: 28px; /* Explicit size */
            height: 28px; /* Explicit size */
        }
        
        h3.step-title { 
            font-size: 1.5rem; /* Slightly larger */
            font-weight: 600; 
            color: #4f46e5; /* Indigo 600 */
            margin-top: 2rem; /* Increased margin */
            margin-bottom: 1rem; /* Increased margin */
        }
        
        .result-section {
            padding: 2rem; /* Increased padding */
            background-color: #f9fafb; /* Tailwind Gray-50, very light gray */
            border: 1px solid #e5e7eb; /* Tailwind Gray-200 */
            border-radius: 0.75rem; /* Increased radius */
            margin-bottom: 2.5rem; /* Increased margin */
            box-shadow: 0 3px 6px rgba(0,0,0,0.03), 0 3px 6px rgba(0,0,0,0.03); /* Softer, more subtle shadow */
        }
        
        .label {
            font-weight: 500; 
            color: #6b7280; /* Tailwind Gray-500 */
            margin-bottom: 0.5rem; /* Increased margin */
            font-size: 0.9rem; /* Slightly larger */
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .value {
            font-weight: 600; 
            color: #3730a3; /* Indigo 800 */
            font-size: 1.375rem; /* Slightly larger */
        }

        /* Grid styling for Status and Optimal Value */
        .status-optimal-grid { /* Added a specific class for this grid if needed, otherwise use the existing structure */
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Responsive columns */
            gap: 1.5rem; /* Increased gap */
        }

        .solution-container { /* Wrapper for solution items if not already gridded */
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Responsive columns for solution variables */
             gap: 1rem;
        }

        .solution-row { /* Replaces .solution-item for clarity with row/column structure */
            display: flex;
            flex-direction: column; /* Stack variable and value */
            background-color: #ffffff;
            padding: 1rem; /* Padding for each item */
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb; /* Gray 200 */
            box-shadow: 0 1px 2px 0 rgba(0,0,0,0.05);
        }
        
        .solution-var {
            font-weight: 500;
            color: #1f2937; /* Tailwind Gray-800 */
            font-size: 0.95rem;
            margin-bottom: 0.375rem; /* Space between var and val */
        }
        .solution-val {
            font-weight: 700; /* Bolder */
            font-size: 1.125rem; /* Larger */
            color: #4338ca; /* Indigo 700 */
            background-color: #eef2ff; /* Indigo 50 for a very subtle highlight */
            padding: 0.375rem 0.625rem; /* Adjusted padding */
            border-radius: 0.375rem; /* Slightly larger radius */
            align-self: flex-start; /* Align to start of the flex container */
        }
        
        .step-details { 
            background-color: #ffffff; 
            border: 1px solid #e5e7eb; /* Tailwind Gray-200 */
            border-radius: 0.5rem; 
            padding: 1.75rem; /* Increased padding */
            margin-bottom: 2rem; /* Increased margin */
            box-shadow: 0 2px 4px 0 rgba(0,0,0,0.05);
        }
        
        pre {
            background-color: #f3f4f6; /* Tailwind Gray-100 */
            padding: 1.5rem; /* Increased padding */
            border-radius: 0.5rem; /* Increased radius */
            overflow-x: auto;
            font-family: 'Roboto Mono', monospace; 
            font-size: 0.9rem; 
            white-space: pre-wrap; 
            border: 1px solid #d1d5db; /* Tailwind Gray-300 */
            color: #111827; /* Tailwind Gray-900 */
            line-height: 1.5; /* Improved line height for code */
        }
        
        ul.solution-list { /* Though not used in current structure, good to have */
            list-style-type: none;
            padding: 0;
        }
                
        img.plot-image { 
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem; 
            margin: 2rem auto; /* Increased margin */
            display: block;
            border: 1px solid #e5e7eb; /* Light border for image (Gray-200) */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08); /* Softer shadow */
        }

        .footer {
            text-align: center;
            padding: 2.5rem 1rem; 
            font-size: 0.875rem; 
            color: #6b7280; /* Tailwind Gray-500 */
            background-color: #f9fafb; /* Tailwind Gray-50 */
            border-top: 1px solid #e5e7eb; /* Tailwind Gray-200 */
            margin-top: 3rem; /* Ensure space above footer */
        }
        
        /* More refined responsive adjustments */
        @media (max-width: 768px) {
            .container-wrapper { margin: 1.5rem; } /* Slightly more margin on smaller screens */
            .results-header { padding: 1.75rem 1.25rem; margin-bottom: 1.5rem; }
            .content-wrapper { padding: 0 1.75rem 1.75rem 1.75rem; }
            h1.main-title { font-size: 2rem; } 
            p.subtitle { font-size: 1.05rem; }
            h2.section-title { font-size: 1.625rem; }
            h3.step-title { font-size: 1.375rem; }
            .back-button { width: 100%; justify-content: center; padding: 0.875rem; }
            .result-section { padding: 1.75rem; }
            .step-details { padding: 1.5rem; }
            pre { font-size: 0.875rem; padding: 1.25rem; }
            .value { font-size: 1.25rem; }
            .solution-container { grid-template-columns: 1fr; gap: 0.75rem; } /* Stack solution items */
            .solution-row { padding: 0.75rem; }
        }
        
        @media (max-width: 480px) {
            .container-wrapper { margin: 1rem 0.75rem; border-radius: 0.5rem; }
            .results-header { padding: 1.5rem 1rem; }
            .content-wrapper { padding: 0 1rem 1rem 1rem; }
            h1.main-title { font-size: 1.75rem; }
            p.subtitle { font-size: 0.95rem; }
            h2.section-title { font-size: 1.375rem; }
            h3.step-title { font-size: 1.2rem; }
            .result-section { padding: 1.25rem; border-radius: 0.5rem; }
            .step-details { padding: 1.25rem; border-radius: 0.375rem; }
            pre { padding: 1rem; font-size: 0.8rem; border-radius: 0.25rem; }
            .value { font-size: 1.1rem; }
             .back-button { font-size: 0.9rem; padding: 0.625rem; }
             .back-button svg { margin-right: 0.5rem; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col"> <div class="container-wrapper my-8"> <header class="results-header">
            <h1 class="main-title">Kết quả bài toán Đơn hình</h1>
            <p class="subtitle">Phương pháp Simplex</p>
        </header>

        <div class="content-wrapper">
            <a href="javascript:history.back()" class="back-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
                Quay lại trang trước
            </a>

            <div class="result-section">
                 <div class="status-optimal-grid"> <div>
                        <p class="label">Trạng thái:</p>
                        <p class="value" id="result-status">{{ result.status }}</p>
                    </div>
                    {% if result.z is not none %}
                        <div> <p class="label">Giá trị tối ưu z*:</p>
                            {% if result.z is number %}
                                <p class="value" id="result-z">{{ "%.2f"|format(result.z) }}</p>
                            {% else %}
                                <p class="value" id="result-z">{{ result.z }}</p>
                            {% endif %}
                        </div>
                    {% else %}
                        <div> <p class="label">Giá trị tối ưu z*:</p>
                            <p class="value" id="result-z">Không xác định</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        
            {% if result.solution %}
            <div class="result-section">
                <h2 class="section-title">
                    <span class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                        </svg>
                    </span>
                    Nghiệm tối ưu
                </h2>
                <div class="solution-container"> {% for var, val in result.solution.items() %}
                        <div class="solution-row"> <span class="solution-var">{{ var }}</span>
                            {% if val is number %}
                                <span class="solution-val">{{ "%.2f"|format(val) }}</span>
                            {% else %}
                                <span class="solution-val">{{ val }}</span>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        
            {% if plot_data %}
            <div class="result-section" id="plot-section">
                 <h2 class="section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" />
                    </svg>
                    Hình ảnh hóa (Bài toán 2 biến)
                </h2>
                <img src="data:image/png;base64,{{ plot_data }}" alt="Biểu đồ miền khả thi và nghiệm tối ưu" class="plot-image" id="plot-image-src">
            </div>
            {% elif result.plot_error_message %}  
            <div class="result-section" id="plot-error-section">
                 <h2 class="section-title">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Lỗi Hình ảnh hóa
                </h2>
                <p class="text-red-600 font-medium p-4 bg-red-50 border border-red-200 rounded-md">{{ result.plot_error_message }}</p> </div>
            {% endif %}

            {% if result.steps and result.steps.items()|length > 0 %}
            <div id="steps-section" class="mt-12"> <h2 class="section-title">
                     <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                    </svg>
                    Chi tiết các bước
                </h2>
                <div id="result-steps" class="space-y-8"> {% for title, tableau in result.steps.items() %}
                    <div class="step-details">
                        <h3 class="step-title">{{ title }}</h3>
                        <pre>
{% if tableau['z'] is not none %}
{{ "%-4s = %s"|format('z', tableau['z']) }}
{{ "───────────────────────────────────────────────────────" }}
{% endif -%}
{% for var, expr in tableau.items() if var != 'z' -%}
{{ "%-4s = %s"|format(var, expr) }}
{% endfor %}
                        </pre>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div> 
    </div> 
    <footer class="footer">
        <p>© 2025 Công cụ Giải Bài toán Quy hoạch Tuyến tính.</p>
    </footer>
</body>
</html>